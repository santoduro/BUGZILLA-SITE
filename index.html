<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>$BUGZILLA - Conquer the Chaos</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Solana Web3.js Library -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    <script>
        // ===============================================================================================
        // !! IMPORTANTE !! INCOLLA LA TUA VERA API KEY DI HELIUS QUI SOTTO !!
        // ===============================================================================================
        window.HELIUS_API_KEY = "LA_TUA_API_KEY_QUI";
    </script>
    <style>
        @keyframes background-pan {
            0% { background-position: 0% center; }
            100% { background-position: -200% center; }
        }
        .animated-gradient {
            background-size: 200% auto;
            background-image: linear-gradient(to right, #2dd4bf, #34d399, #a3e635, #facc15, #a3e635, #34d399, #2dd4bf);
            animation: background-pan 3s linear infinite;
        }
        /* Stile per l'header dinamico */
        @keyframes header-pan {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }
        .header-animated-bg {
            background-size: 200% 200%;
            background-image: linear-gradient(110deg, rgba(31, 0, 92, 0.2), rgba(9, 9, 11, 0.5) 25%, rgba(9, 9, 11, 0.5) 75%, rgba(0, 27, 61, 0.2));
            animation: header-pan 15s linear infinite;
        }
        /* Stile per il ticker banner */
        @keyframes ticker-scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .ticker-wrap {
            width: 100%;
            overflow: hidden;
        }
        .ticker-move {
            display: inline-block;
            white-space: nowrap;
            animation: ticker-scroll 20s linear infinite;
        }
    </style>
</head>
<body class="bg-black text-white font-sans">

    <main>
        <!-- HEADER -->
        <header class="relative shadow-md sticky top-0 z-50 border-b border-zinc-800 header-animated-bg">
            <div class="relative z-10 flex justify-between items-center px-6 py-4">
                <div class="flex items-center gap-3">
                    <img src="/assets/bugzilla3.png" alt="$BUGZILLA Logo" class="w-12 h-12 rounded-full" />
                    <h1 class="text-3xl font-extrabold text-green-400 tracking-widest">$BUGZILLA</h1>
                </div>
                <div id="wallet-container" class="relative">
                    <button id="dashboard-button" class="hidden items-center gap-2 bg-zinc-800 border border-zinc-700 rounded-full py-2 px-4 hover:bg-zinc-700 transition-colors">
                        <span id="dashboard-address" class="font-bold text-sm"></span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                    </button>
                    <div id="wallet-dashboard" class="hidden absolute top-full right-0 mt-2 w-80 bg-zinc-900/90 backdrop-blur-md border border-zinc-700 rounded-2xl shadow-lg z-50">
                        <div class="p-4">
                            <div class="flex justify-between items-center mb-4">
                                <p class="text-sm text-gray-400">My Wallet</p>
                                <button id="copy-address-btn" title="Copy Address" class="text-gray-400 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                                </button>
                            </div>
                            <div id="token-list-container" class="max-h-60 overflow-y-auto pr-2">
                                <div id="token-list-loader" class="text-center py-4">
                                    <p class="text-gray-400">Loading tokens...</p>
                                </div>
                            </div>
                            <button id="disconnect-btn" class="w-full mt-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg transition-colors">Disconnect</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- TICKER BANNER -->
        <div class="bg-yellow-400 text-black py-2 ticker-wrap">
            <div class="ticker-move">
                <span class="font-bold mx-8">üî• Live on <a href="https://pump.fun" target="_blank" class="underline">Pump.fun</a> before it explodes üî•</span>
                <span class="font-bold mx-8">üî• Live on <a href="https://pump.fun" target="_blank" class="underline">Pump.fun</a> before it explodes üî•</span>
                <span class="font-bold mx-8">üî• Live on <a href="https://pump.fun" target="_blank" class="underline">Pump.fun</a> before it explodes üî•</span>
            </div>
        </div>

        <!-- SEZIONE HERO -->
        <section class="relative min-h-screen flex flex-col items-center justify-center text-center p-6 bg-gradient-to-br from-orange-600 via-red-700 to-orange-600">
            <div class="flex flex-col items-center gap-4 z-10">
                <h2 class="text-8xl md:text-9xl font-black text-white tracking-wider drop-shadow-lg" style="font-family: Impact, sans-serif;">BUGZILLA</h2>
                <img src="/assets/bugzilla2.png" alt="Bugzilla" class="w-64 h-auto rounded-2xl shadow-2xl border-4 border-yellow-400 my-4">
                <p class="text-2xl font-bold text-yellow-300 drop-shadow-md">The most viral meme-token on Solana</p>
                <button id="hero-connect-button" class="mt-6 bg-green-600 hover:bg-green-700 text-white text-xl font-bold py-3 px-8 rounded-lg shadow-xl border-2 border-green-400 hover:scale-105 transition-all">
                    <span>Connect Wallet</span>
                </button>
            </div>
        </section>

        <!-- SEZIONE WHERE TO BUY (RIPRISTINATA) -->
        <section class="px-6 max-w-7xl mx-auto py-16 text-center bg-black">
            <h2 class="text-5xl font-bold text-white mb-12 tracking-wide">Where to Buy</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <!-- Card Pump.fun -->
                <div class="bg-zinc-900/70 backdrop-blur-sm p-8 rounded-2xl shadow-2xl border border-white/10 flex flex-col items-center text-center">
                    <img src="/assets/pump-logo.png" alt="Pump.fun Logo" class="w-24 h-24 mb-4">
                    <h3 class="text-3xl font-bold text-white mb-2">Pump.fun</h3>
                    <p class="text-gray-400 mb-6 flex-grow">Get in early. Be part of the initial swarm before the Raydium launch.</p>
                    <a href="https://pump.fun/" target="_blank" rel="noopener noreferrer" class="w-full bg-white text-black font-bold py-3 px-8 rounded-lg hover:bg-gray-200 transition-colors">BUY NOW</a>
                </div>
                <!-- Card Raydium -->
                <div class="bg-zinc-900/70 backdrop-blur-sm p-8 rounded-2xl shadow-2xl border border-white/10 flex flex-col items-center text-center">
                    <svg class="w-24 h-24 mb-4" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M32 0L39.36 10.72L51.68 12.96L43.28 22.48L44.48 35.36L32 30.24L19.52 35.36L20.72 22.48L12.32 12.96L24.64 10.72L32 0Z" fill="#3B82F6"></path><path d="M32 64L39.36 53.28L51.68 51.04L43.28 41.52L44.48 28.64L32 33.76L19.52 28.64L20.72 41.52L12.32 51.04L24.64 53.28L32 64Z" fill="#60A5FA"></path></svg>
                    <h3 class="text-3xl font-bold text-white mb-2">Raydium</h3>
                    <p class="text-gray-400 mb-6 flex-grow">Trade $BUGZILLA on Solana's leading DEX with deep liquidity.</p>
                    <a href="https://raydium.io/" target="_blank" rel="noopener noreferrer" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">TRADE NOW</a>
                </div>
            </div>
        </section>

        <!-- SEZIONE CANVAS -->
        <section class="relative h-[550px] bg-black flex flex-col justify-center items-center overflow-hidden py-12">
            <div class="w-full max-w-5xl mx-auto flex flex-col items-center gap-8">
                <canvas id="matrix-canvas" class="w-full h-[400px]"></canvas>
                <div class="w-full max-w-2xl px-4">
                    <div class="w-full bg-zinc-800/50 rounded-full h-8 border-2 border-zinc-700 shadow-inner relative overflow-hidden">
                        <div id="progress-bar-inner" class="animated-gradient h-full rounded-full transition-all duration-500 ease-linear" style="width: 0%;"></div>
                        <span id="progress-percentage" class="absolute inset-0 flex items-center justify-center text-lg font-bold text-white drop-shadow-lg">0%</span>
                    </div>
                </div>
                <button id="claim-button" disabled class="mt-2 bg-zinc-700 text-zinc-500 font-bold text-xl py-4 px-10 rounded-lg shadow-lg cursor-not-allowed opacity-50 transition-all duration-500 flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                    <span>CLAIM AIRDROP$</span>
                </button>
            </div>
        </section>

        <!-- SEZIONE TOKENOMICS -->
        <section class="px-6 max-w-7xl mx-auto py-16">
          <div class="bg-zinc-900/70 backdrop-blur-sm p-8 md:p-10 rounded-2xl shadow-2xl border border-white/10 relative overflow-hidden">
            <img src="/assets/bugzilla4.png" alt="Tokenomics Background" class="absolute top-0 left-0 w-full h-full object-cover opacity-10 z-0">
            <div class="relative z-10">
                <h3 class="text-4xl font-bold text-center text-white mb-10 tracking-wide">Tokenomics</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 text-left text-lg">
                  <div class="bg-zinc-800/50 p-6 rounded-xl border border-white/10 flex flex-col items-start gap-3">
                    <span class="text-3xl">üåê</span>
                    <p class="text-gray-400 font-semibold">Total Supply</p>
                    <h4 id="total-supply" class="text-2xl font-bold text-green-400">1,000,000,000</h4>
                    <p class="text-sm text-gray-500">The total amount of $BUGZILLA that will ever exist.</p>
                  </div>
                  <div class="bg-zinc-800/50 p-6 rounded-xl border border-white/10 flex flex-col items-start gap-3">
                    <span class="text-3xl">üîí</span>
                    <p class="text-gray-400 font-semibold">Liquidity</p>
                    <h4 class="text-2xl font-bold text-green-400">100% Locked</h4>
                    <p class="text-sm text-gray-500">Ensures a stable market and prevents rug-pulls by locking the initial pool.</p>
                  </div>
                  <div class="bg-zinc-800/50 p-6 rounded-xl border border-white/10 flex flex-col items-start gap-3">
                    <span class="text-3xl">üöÄ</span>
                    <p class="text-gray-400 font-semibold">Transaction Tax</p>
                    <h4 class="text-2xl font-bold text-green-400">0% Buy / 0% Sell</h4>
                    <p class="text-sm text-gray-500">You keep 100% of your tokens when you buy, sell, or trade.</p>
                  </div>
                  <div class="bg-zinc-800/50 p-6 rounded-xl border border-white/10 flex flex-col items-start gap-3">
                    <span class="text-3xl">üë•</span>
                    <p class="text-gray-400 font-semibold">Ownership</p>
                    <h4 class="text-2xl font-bold text-green-400">Renounced</h4>
                    <p class="text-sm text-gray-500">The contract is renounced, putting full control in the hands of the community.</p>
                  </div>
                </div>
            </div>
          </div>
        </section>

        <!-- SEZIONE NFT MARKETPLACE -->
        <section class="px-6 max-w-7xl mx-auto py-16">
            <div class="bg-zinc-900/70 backdrop-blur-sm p-8 md:p-12 rounded-2xl shadow-2xl border border-white/10 text-center">
                <h2 class="text-5xl font-bold text-white mb-4 tracking-wide">$BUGGAME Minting Station</h2>
                <p class="text-lg text-gray-400 max-w-2xl mx-auto mb-10">
                    Mint your official $BUGGAME NFT. Each mint grants you a unique, playable asset in the upcoming Bugzilla game.
                </p>

                <!-- Griglia di Minting con Immagini -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                    <!-- Card di Minting con Immagine e Descrizione -->
                    <div class="bg-zinc-800/50 rounded-xl border border-zinc-700 flex flex-col text-center overflow-hidden">
                        <img src="/assets/casella1.png" alt="Random NFT" class="w-full h-40 object-cover">
                        <div class="p-4 flex flex-col flex-grow">
                            <h4 class="text-xl font-bold text-white">Random</h4>
                            <p class="text-sm text-gray-400 flex-grow my-2">A chance to pull any rarity. High risk, high reward.</p>
                            <p class="text-3xl font-bold text-green-400 my-2">$10</p>
                            <button class="buy-nft-btn w-full mt-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 rounded-lg" data-rarity="Random" data-price="10">BUY NFT</button>
                        </div>
                    </div>
                    <div class="bg-zinc-800/50 rounded-xl border border-zinc-700 flex flex-col text-center overflow-hidden">
                        <img src="/assets/casella2.png" alt="Common NFT" class="w-full h-40 object-cover">
                        <div class="p-4 flex flex-col flex-grow">
                            <h4 class="text-xl font-bold text-white">Common</h4>
                            <p class="text-sm text-gray-400 flex-grow my-2">The backbone of the swarm. A solid asset for any player.</p>
                            <p class="text-3xl font-bold text-green-400 my-2">$15</p>
                            <button class="buy-nft-btn w-full mt-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 rounded-lg" data-rarity="Common" data-price="15">BUY NFT</button>
                        </div>
                    </div>
                    <div class="bg-zinc-800/50 rounded-xl border border-zinc-700 flex flex-col text-center overflow-hidden">
                        <img src="/assets/casella3.png" alt="Epic NFT" class="w-full h-40 object-cover">
                        <div class="p-4 flex flex-col flex-grow">
                            <h4 class="text-xl font-bold text-blue-400">Epic</h4>
                            <p class="text-sm text-gray-400 flex-grow my-2">A superior bug with enhanced abilities. A true threat on the battlefield.</p>
                            <p class="text-3xl font-bold text-green-400 my-2">$25</p>
                            <button class="buy-nft-btn w-full mt-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 rounded-lg" data-rarity="Epic" data-price="25">BUY NFT</button>
                        </div>
                    </div>
                    <div class="bg-zinc-800/50 rounded-xl border border-zinc-700 flex flex-col text-center overflow-hidden">
                        <img src="/assets/casella4.png" alt="Legendary NFT" class="w-full h-40 object-cover">
                        <div class="p-4 flex flex-col flex-grow">
                            <h4 class="text-xl font-bold text-purple-400">Legendary</h4>
                            <p class="text-sm text-gray-400 flex-grow my-2">A mythical creature of immense power. Few will ever own one.</p>
                            <p class="text-3xl font-bold text-green-400 my-2">$50</p>
                            <button class="buy-nft-btn w-full mt-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 rounded-lg" data-rarity="Legendary" data-price="50">BUY NFT</button>
                        </div>
                    </div>
                </div>
                
                <!-- Card $BUGGER in evidenza -->
                <div class="w-full max-w-2xl mx-auto">
                    <div class="bg-zinc-800/50 rounded-xl border-2 border-yellow-400 flex flex-col md:flex-row text-center md:text-left overflow-hidden shadow-lg shadow-yellow-500/20">
                        <img src="/assets/casella5.png" alt="$BUGGER NFT" class="w-full md:w-64 h-auto object-cover">
                        <div class="p-6 flex flex-col flex-grow">
                            <h4 class="text-3xl font-bold text-yellow-400">$BUGGER</h4>
                            <p class="text-md text-gray-300 flex-grow my-3">The ultimate life form. The apex predator of the Bugzilla ecosystem. This is not just an NFT, it's a statement.</p>
                            <p class="text-4xl font-bold text-green-400 my-2">$100</p>
                            <button class="buy-nft-btn w-full mt-auto bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-3 rounded-lg" data-rarity="$BUGGER" data-price="100">BUY THE APEX</button>
                        </div>
                    </div>
                </div>

                <!-- Marketplace Generale con Creazione -->
                <div class="flex justify-between items-center mb-6 border-t border-zinc-700 pt-10 mt-12">
                    <h4 class="text-2xl font-bold text-white">Community Creations</h4>
                    <button id="create-nft-button" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:scale-105 transition-all">
                        Create your NFT
                    </button>
                </div>
                <div class="min-h-[200px] bg-zinc-800/50 rounded-lg p-8 flex items-center justify-center">
                    <p class="text-gray-500">The marketplace is currently empty. Be the first to create an NFT!</p>
                </div>
            </div>
        </section>

        <!-- SEZIONE COMMUNITY -->
        <section class="px-6 max-w-7xl mx-auto py-16">
            <div class="bg-zinc-900/70 backdrop-blur-sm p-8 md:p-12 rounded-2xl shadow-2xl border border-white/10 text-center flex flex-col md:flex-row items-center gap-8">
                <img src="/assets/bugzilla1.png" alt="Community" class="w-48 h-48 rounded-full shadow-lg shadow-purple-500/20 object-cover">
                <div class="text-center md:text-left">
                    <h3 class="text-4xl font-bold text-white mb-4 tracking-wide">Join The Swarm</h3>
                    <p class="text-lg text-gray-400 max-w-2xl mx-auto mb-6">
                        Alpha leaks, community events, and the future of the infestation are discussed on Telegram. Don't miss out.
                    </p>
                    <a href="https://t.me/Bugzil_la" target="_blank" rel="noopener noreferrer" class="inline-block bg-blue-500 hover:bg-blue-600 text-white text-xl font-bold py-4 px-10 rounded-full shadow-xl hover:scale-105 transition-all">
                        <span>Join Telegram</span>
                    </a>
                </div>
            </div>
        </section>

        <footer class="py-8 text-center text-gray-500 text-sm">
          <p>¬© 2025 Bugzilla. All rights reserved.</p>
        </footer>
    </main>

    <!-- MODAL CONNESSIONE WALLET -->
    <div id="wallet-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50">
        <div class="bg-zinc-800 p-8 rounded-2xl shadow-lg border border-white/10 w-full max-w-xs text-center">
            <h3 class="text-xl font-bold mb-6">Select a Wallet</h3>
            <div class="flex flex-col gap-4">
                <button id="phantom-btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg transition-colors">Connect Phantom</button>
                <button id="solflare-btn" class="w-full bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-3 px-4 rounded-lg transition-colors">Connect Solflare</button>
            </div>
            <button id="close-modal-btn" class="mt-6 text-gray-400 hover:text-white">Cancel</button>
        </div>
    </div>

    <!-- MODAL CONFERMA ACQUISTO NFT -->
    <div id="nft-purchase-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50 p-4">
        <div class="bg-zinc-900 border border-zinc-700 p-8 rounded-2xl shadow-lg w-full max-w-md text-left relative">
            <button id="close-purchase-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <h3 class="text-2xl font-bold mb-2 text-white">Confirm Purchase</h3>
            <p class="text-gray-400 mb-6">You are about to mint a new $BUGGAME NFT.</p>
            
            <div class="space-y-4">
                <div class="flex justify-between items-center">
                    <span class="text-gray-300">Rarity:</span>
                    <span id="purchase-rarity" class="font-bold text-white"></span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-300">Price (USD):</span>
                    <span id="purchase-price-usd" class="font-bold text-white"></span>
                </div>
                <div class="flex justify-between items-center border-t border-zinc-700 pt-4 mt-4">
                    <span class="text-gray-300">Total (approx.):</span>
                    <span id="purchase-price-sol" class="font-bold text-green-400"></span>
                </div>
                <p class="text-xs text-center text-gray-500 pt-2">*Price in SOL is based on the current market rate and may vary slightly.</p>
            </div>

            <div class="pt-6">
                <button id="confirm-purchase-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition-all">
                    Confirm & Mint
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL CREAZIONE NFT -->
    <div id="nft-creation-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50 p-4">
        <div class="bg-zinc-900 border border-zinc-700 p-8 rounded-2xl shadow-lg w-full max-w-md text-left relative">
            <button id="close-nft-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <h3 class="text-2xl font-bold mb-6 text-white">Create your Bugzilla NFT</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Image or GIF</label>
                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-zinc-600 border-dashed rounded-md">
                        <div class="space-y-1 text-center">
                            <img id="nft-image-preview" src="" alt="NFT Preview" class="hidden mx-auto h-24 w-auto mb-4">
                            <svg id="nft-image-placeholder" class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                            <div class="flex text-sm text-gray-500">
                                <label for="nft-file-upload" class="relative cursor-pointer bg-zinc-800 rounded-md font-medium text-green-400 hover:text-green-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-offset-zinc-900 focus-within:ring-green-500 px-2">
                                    <span>Upload a file</span>
                                    <input id="nft-file-upload" name="nft-file-upload" type="file" class="sr-only" accept="image/png, image/jpeg, image/gif">
                                </label>
                                <p class="pl-1">or drag and drop</p>
                            </div>
                            <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                        </div>
                    </div>
                </div>

                <div>
                    <label for="nft-name" class="block text-sm font-medium text-gray-300">Name</label>
                    <input type="text" id="nft-name" class="mt-1 block w-full bg-zinc-800 border-zinc-600 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm p-2">
                </div>
                <div>
                    <label for="nft-description" class="block text-sm font-medium text-gray-300">Description</label>
                    <textarea id="nft-description" rows="3" class="mt-1 block w-full bg-zinc-800 border-zinc-600 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm p-2"></textarea>
                </div>
                <div>
                    <label for="nft-rarity" class="block text-sm font-medium text-gray-300">Rarity</label>
                    <select id="nft-rarity" class="mt-1 block w-full bg-zinc-800 border-zinc-600 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm p-2">
                        <option>Common</option>
                        <option>Uncommon</option>
                        <option>Rare</option>
                        <option>Epic</option>
                        <option>Legendary</option>
                    </select>
                </div>

                <div class="pt-4">
                    <p class="text-sm text-gray-400 mb-2">Minting Fee</p>
                    <div class="flex gap-4">
                        <button id="pay-sol-btn" class="flex-1 bg-purple-600 border-2 border-purple-600 text-white font-bold py-2 rounded-lg">0.02 SOL</button>
                        <button id="pay-bugz-btn" class="flex-1 bg-transparent border-2 border-zinc-600 text-gray-400 font-bold py-2 rounded-lg">1,000,000 $BUGZ</button>
                    </div>
                </div>

                <div class="pt-4">
                    <button id="mint-nft-button" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition-all">
                        Create & Mint NFT
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- IL NOSTRO SCRIPT ORA √à QUI SOTTO -->
    <script>
        // Attende che la pagina sia completamente caricata prima di eseguire qualsiasi cosa
        window.onload = () => {

            // --- CONFIGURAZIONE ---
            const HELIUS_API_KEY = window.HELIUS_API_KEY; 
            const BUGZILLA_MINT_ADDRESS = "YOUR_BUGZILLA_MINT_ADDRESS_HERE";
            const PIXELATION_LEVEL = 8;
            const SOLANA_RPC_URL = `https://mainnet.helius-rpc.com/?api-key=${HELIUS_API_KEY}`;

            // --- OGGETTI SOLANA WEB3 ---
            const { Connection, PublicKey } = solanaWeb3;
            const connection = new Connection(SOLANA_RPC_URL);

            // --- SELEZIONE DEGLI ELEMENTI DEL DOM ---
            const canvas = document.getElementById('matrix-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            // UI Principale
            const totalSupplyText = document.getElementById('total-supply');
            const heroConnectButton = document.getElementById('hero-connect-button');
            const progressBarInner = document.getElementById('progress-bar-inner');
            const progressPercentage = document.getElementById('progress-percentage');
            const claimButton = document.getElementById('claim-button');

            // UI Wallet e Dashboard
            const walletContainer = document.getElementById('wallet-container');
            const dashboardButton = document.getElementById('dashboard-button');
            const dashboardAddress = document.getElementById('dashboard-address');
            const walletDashboard = document.getElementById('wallet-dashboard');
            const copyAddressBtn = document.getElementById('copy-address-btn');
            const tokenListContainer = document.getElementById('token-list-container');
            const tokenListLoader = document.getElementById('token-list-loader');
            const disconnectBtn = document.getElementById('disconnect-btn');
            
            // Modal Connessione
            const walletModal = document.getElementById('wallet-modal');
            const phantomBtn = document.getElementById('phantom-btn');
            const solflareBtn = document.getElementById('solflare-btn');
            const closeModalBtn = document.getElementById('close-modal-btn');

            // Modal Creazione NFT
            const nftCreationModal = document.getElementById('nft-creation-modal');
            const createNftButton = document.getElementById('create-nft-button');
            const closeNftModalBtn = document.getElementById('close-nft-modal-btn');
            const nftFileUpload = document.getElementById('nft-file-upload');
            const nftImagePreview = document.getElementById('nft-image-preview');
            const nftImagePlaceholder = document.getElementById('nft-image-placeholder');
            const mintNftButton = document.getElementById('mint-nft-button');
            const paySolBtn = document.getElementById('pay-sol-btn');
            const payBugzBtn = document.getElementById('pay-bugz-btn');

            // Modal Acquisto NFT
            const nftPurchaseModal = document.getElementById('nft-purchase-modal');
            const buyNftButtons = document.querySelectorAll('.buy-nft-btn');
            const closePurchaseModalBtn = document.getElementById('close-purchase-modal-btn');
            const purchaseRarityEl = document.getElementById('purchase-rarity');
            const purchasePriceUsdEl = document.getElementById('purchase-price-usd');
            const purchasePriceSolEl = document.getElementById('purchase-price-sol');
            const confirmPurchaseBtn = document.getElementById('confirm-purchase-btn');

            // --- STATO E VARIABILI GLOBALI ---
            let progress = 0;
            let totalSupply = 1_000_000_000;
            let roachImage = null;
            let pixelData = [];
            let connectedWallet = null;
            let fullAddress = '';
            let drops = [];
            let columns;
            const fontSize = 12;
            const chars = "‚ñë‚ñí‚ñì‚ñà‚ñå‚ñê‚óé‚ú∂‚òÑ‚òÖ‚ú¶‚úß";
            let paymentMethod = 'SOL'; // Default payment
            let currentPurchase = {};

            // --- FUNZIONI DI SETUP E ANIMAZIONE ---
            function setCanvasDimensions() {
                canvas.width = canvas.clientWidth;
                canvas.height = canvas.clientHeight;
                columns = Math.floor(canvas.width / fontSize);
                drops = [];
                for (let i = 0; i < columns; i++) {
                    drops[i] = 1;
                }
            }

            const img = new Image();
            img.src = '/assets/blatta1.png';
            img.onload = () => {
                roachImage = img;
                preparePixelData();
            };
            img.onerror = () => console.error("ERRORE CRITICO: Impossibile caricare l'immagine '/assets/blatta1.png'.");

            function preparePixelData() {
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = roachImage.width;
                tempCanvas.height = roachImage.height;
                tempCtx.drawImage(roachImage, 0, 0);
                const imageData = tempCtx.getImageData(0, 0, roachImage.width, roachImage.height).data;
                pixelData = [];
                for (let y = 0; y < roachImage.height; y += PIXELATION_LEVEL) {
                    for (let x = 0; x < roachImage.width; x += PIXELATION_LEVEL) {
                        const i = (y * roachImage.width + x) * 4;
                        if (imageData[i + 3] > 128) {
                            pixelData.push({ x, y, color: `rgba(${imageData[i]}, ${imageData[i+1]}, ${imageData[i+2]}, ${imageData[i+3]})` });
                        }
                    }
                }
                pixelData.sort(() => Math.random() - 0.5);
            }

            function activateClaimButton() {
                claimButton.disabled = false;
                claimButton.classList.remove('bg-zinc-700', 'text-zinc-500', 'cursor-not-allowed', 'opacity-50');
                claimButton.classList.add('bg-green-500', 'text-white', 'hover:bg-green-400', 'shadow-lg', 'shadow-green-500/50');
                claimButton.addEventListener('click', () => alert("Airdrop claimed! (Demo)"));
            }

            setInterval(() => {
                if (progress < 100) {
                    progress += 0.2;
                    const currentProgress = Math.floor(progress);
                    progressBarInner.style.width = `${currentProgress}%`;
                    progressPercentage.textContent = `${currentProgress}%`;
                    if (currentProgress >= 100) activateClaimButton();
                }
            }, 120);

            setInterval(() => {
                const amountToDecrease = Math.floor(Math.random() * 10000) + 500;
                totalSupply = Math.max(0, totalSupply - amountToDecrease);
                totalSupplyText.textContent = totalSupply.toLocaleString('en-US');
            }, 2500);

            function draw() {
                if (!ctx) return;
                ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = "#39ff14";
                ctx.font = `${fontSize}px monospace`;
                for (let i = 0; i < drops.length; i++) {
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
                
                if (roachImage && pixelData.length > 0) {
                    const imgAspectRatio = roachImage.width / roachImage.height;
                    const canvasHeight = canvas.height * 0.9;
                    const imgHeight = canvasHeight;
                    const imgWidth = imgHeight * imgAspectRatio;
                    const xOffset = (canvas.width / 2) - (imgWidth / 2);
                    const yOffset = (canvas.height / 2) - (imgHeight / 2);
                    const scaleX = imgWidth / roachImage.width;
                    const scaleY = imgHeight / roachImage.height;
                    const pixelsToDraw = Math.floor((progress / 100) * pixelData.length);
                    for (let i = 0; i < pixelsToDraw; i++) {
                        const pixel = pixelData[i];
                        ctx.fillStyle = pixel.color;
                        ctx.fillRect(xOffset + pixel.x * scaleX, yOffset + pixel.y * scaleY, PIXELATION_LEVEL * scaleX, PIXELATION_LEVEL * scaleY);
                    }
                }
            }
            
            function animationLoop() {
                draw();
                requestAnimationFrame(animationLoop);
            }

            // --- LOGICA DELLA DASHBOARD E DEL WALLET ---

            function toggleDashboard() {
                walletDashboard.classList.toggle('hidden');
            }

            function updateUiToConnectedState(publicKey) {
                fullAddress = publicKey.toString();
                const shortAddress = `${fullAddress.substring(0, 4)}...${fullAddress.substring(fullAddress.length - 4)}`;
                dashboardButton.classList.remove('hidden');
                dashboardButton.classList.add('flex');
                dashboardAddress.textContent = shortAddress;
                heroConnectButton.classList.add('hidden');
                fetchAndDisplayTokens(fullAddress);
            }

            function updateUiToDisconnectedState() {
                dashboardButton.classList.add('hidden');
                dashboardButton.classList.remove('flex');
                walletDashboard.classList.add('hidden');
                heroConnectButton.classList.remove('hidden');
                connectedWallet = null;
                fullAddress = '';
            }

            async function fetchAndDisplayTokens(publicKeyString) {
                if (HELIUS_API_KEY === "LA_TUA_API_KEY_QUI") {
                    console.error("ERRORE: Inserisci la tua API Key di Helius nel file bugzilla.html");
                    tokenListContainer.innerHTML = `<p class="text-center text-red-500">API Key missing in HTML.</p>`;
                    return;
                }

                tokenListContainer.innerHTML = '';
                tokenListLoader.style.display = 'block';

                try {
                    const ownerPublicKey = new PublicKey(publicKeyString);
                    const [solBalance, tokenAccounts] = await Promise.all([
                        connection.getBalance(ownerPublicKey),
                        connection.getParsedTokenAccountsByOwner(ownerPublicKey, {
                            programId: new PublicKey('TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA')
                        })
                    ]);

                    const tokensWithBalance = tokenAccounts.value
                        .map(acc => acc.account.data.parsed.info)
                        .filter(info => info.tokenAmount.uiAmount > 0);
                    
                    let allTokens = [];

                    if (solBalance > 0) {
                        allTokens.push({
                            isNative: true,
                            mint: 'So11111111111111111111111111111111111111112',
                            balance: (solBalance / solanaWeb3.LAMPORTS_PER_SOL).toLocaleString('en-US', { maximumFractionDigits: 4 }),
                            symbol: 'SOL',
                            logo: 'https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png'
                        });
                    }

                    if (tokensWithBalance.length > 0) {
                        const mintAddresses = tokensWithBalance.map(t => t.mint);
                        const response = await fetch(SOLANA_RPC_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                jsonrpc: '2.0',
                                id: 'bugzilla-dapp',
                                method: 'getAssetBatch',
                                params: { ids: mintAddresses },
                            }),
                        });
                        const { result: assets } = await response.json();
                        
                        const enrichedSplTokens = tokensWithBalance.map(token => {
                            const asset = assets.find(a => a.id === token.mint);
                            return {
                                isNative: false,
                                mint: token.mint,
                                balance: parseFloat(token.tokenAmount.uiAmountString).toLocaleString('en-US', { maximumFractionDigits: 2 }),
                                symbol: asset?.content?.metadata?.symbol || (token.mint === BUGZILLA_MINT_ADDRESS ? '$BUGZILLA' : token.mint.substring(0, 6) + '...'),
                                logo: asset?.content?.links?.image || (token.mint === BUGZILLA_MINT_ADDRESS ? '/assets/bugzilla1.png' : 'https://placehold.co/32x32/374151/9ca3af?text=?')
                            };
                        });
                        allTokens.push(...enrichedSplTokens);
                    }

                    allTokens.sort((a, b) => {
                        if (a.isNative) return -1;
                        if (b.isNative) return 1;
                        if (a.mint === BUGZILLA_MINT_ADDRESS) return -1;
                        if (b.mint === BUGZILLA_MINT_ADDRESS) return 1;
                        return 0;
                    });

                    tokenListLoader.style.display = 'none';

                    if (allTokens.length === 0) {
                        tokenListContainer.innerHTML = `<p class="text-center text-gray-500">No assets found.</p>`;
                        return;
                    }

                    allTokens.forEach(token => {
                        const tokenEl = document.createElement('div');
                        tokenEl.className = 'flex items-center justify-between p-2 rounded-lg hover:bg-zinc-800';
                        tokenEl.innerHTML = `
                            <div class="flex items-center gap-3">
                                <img src="${token.logo}" class="w-8 h-8 rounded-full bg-zinc-700" alt="${token.symbol} logo" onerror="this.src='https://placehold.co/32x32/374151/9ca3af?text=?'">
                                <span class="font-bold">${token.symbol}</span>
                            </div>
                            <span class="text-gray-300">${token.balance}</span>
                        `;
                        tokenListContainer.appendChild(tokenEl);
                    });

                } catch (error) {
                    console.error("Impossibile recuperare i token:", error);
                    tokenListLoader.style.display = 'none';
                    tokenListContainer.innerHTML = `<p class="text-center text-red-500">Failed to load tokens.</p>`;
                }
            }

            async function handleConnection(provider) {
                try {
                    await provider.connect();
                    const publicKey = provider.publicKey;
                    const message = `Sign this message to verify you are the owner of this wallet for $BUGZILLA.`;
                    const encodedMessage = new TextEncoder().encode(message);
                    await provider.signMessage(encodedMessage, "utf8");
                    
                    connectedWallet = provider;
                    updateUiToConnectedState(publicKey);
                    closeModal();
                } catch (err) {
                    console.error("Connessione o firma fallita:", err);
                    updateUiToDisconnectedState();
                }
            }

            async function connectPhantom() {
                if ('phantom' in window && window.phantom.solana) await handleConnection(window.phantom.solana);
                else window.open('https://phantom.app/', '_blank');
            }

            async function connectSolflare() {
                if ('solflare' in window) await handleConnection(window.solflare);
                else window.open('https://solflare.com/', '_blank');
            }
            
            async function disconnectWallet() {
                if (connectedWallet && connectedWallet.disconnect) {
                    try {
                        await connectedWallet.disconnect();
                    } catch (error) {
                        console.error("Errore durante la disconnessione:", error);
                    }
                }
                updateUiToDisconnectedState();
            }

            function copyAddress() {
                if (!fullAddress) return;
                const textArea = document.createElement("textarea");
                textArea.value = fullAddress;
                textArea.style.position = "fixed";
                textArea.style.left = "-9999px";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    copyAddressBtn.title = 'Copied!';
                    setTimeout(() => { copyAddressBtn.title = 'Copy Address'; }, 2000);
                } catch (err) {
                    console.error('Fallback: Impossibile copiare l\'indirizzo', err);
                }
                document.body.removeChild(textArea);
            }

            function openModal() {
                walletModal.classList.remove('hidden');
            }

            function closeModal() {
                walletModal.classList.add('hidden');
            }

            // --- LOGICA MODAL ACQUISTO NFT ---
            async function openPurchaseModal(rarity, priceUsd) {
                if (!connectedWallet) {
                    alert("Please connect your wallet first to mint an NFT.");
                    return;
                }
                
                purchaseRarityEl.textContent = rarity;
                purchasePriceUsdEl.textContent = `$${priceUsd}`;
                purchasePriceSolEl.textContent = "Loading price...";
                
                currentPurchase = { rarity, priceUsd };
                nftPurchaseModal.classList.remove('hidden');

                try {
                    // Fetch current SOL price from CoinGecko API
                    const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd');
                    const data = await response.json();
                    const solPrice = data.solana.usd;
                    const priceInSol = (priceUsd / solPrice).toFixed(5);
                    purchasePriceSolEl.textContent = `~${priceInSol} SOL`;
                    currentPurchase.priceSol = priceInSol;
                } catch (error) {
                    console.error("Failed to fetch SOL price:", error);
                    purchasePriceSolEl.textContent = "Error";
                }
            }

            function closePurchaseModal() {
                nftPurchaseModal.classList.add('hidden');
            }

            async function handlePurchase() {
                alert(`Simulazione di acquisto per 1 NFT ${currentPurchase.rarity} per ~${currentPurchase.priceSol} SOL.`);
                try {
                    const message = `Confirming purchase of 1 ${currentPurchase.rarity} $BUGGAME NFT for ~$${currentPurchase.priceUsd}.`;
                    const encodedMessage = new TextEncoder().encode(message);
                    await connectedWallet.signMessage(encodedMessage, "utf8");
                    alert("Signature successful! Your NFT would be minted now.");
                    closePurchaseModal();
                } catch (error) {
                    alert("Signature was cancelled. Purchase failed.");
                }
            }

            // --- LOGICA MODAL CREAZIONE NFT ---
            function openNftModal() {
                if (!connectedWallet) {
                    alert("Please connect your wallet first to create an NFT.");
                    return;
                }
                nftCreationModal.classList.remove('hidden');
            }

            function closeNftModal() {
                nftCreationModal.classList.add('hidden');
            }

            nftFileUpload.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        nftImagePreview.src = event.target.result;
                        nftImagePreview.classList.remove('hidden');
                        nftImagePlaceholder.classList.add('hidden');
                    };
                    reader.readAsDataURL(file);
                }
            });

            paySolBtn.addEventListener('click', () => {
                paymentMethod = 'SOL';
                paySolBtn.classList.add('border-green-500');
                paySolBtn.classList.remove('border-zinc-600', 'text-gray-400');
                payBugzBtn.classList.remove('border-green-500');
                payBugzBtn.classList.add('border-zinc-600', 'text-gray-400');
            });
            payBugzBtn.addEventListener('click', () => {
                paymentMethod = 'BUGZ';
                payBugzBtn.classList.add('border-green-500');
                payBugzBtn.classList.remove('border-zinc-600', 'text-gray-400');
                paySolBtn.classList.remove('border-green-500');
                paySolBtn.classList.add('border-zinc-600', 'text-gray-400');
            });

            async function handleMint() {
                alert(`Simulazione di minting con ${paymentMethod}... In un'app reale, questo richiederebbe l'upload dell'immagine su IPFS, la creazione dei metadati e l'invio di una transazione complessa con Metaplex.`);
                // SIMULAZIONE: Chiedi una firma per mostrare il processo
                try {
                    const message = `Simulating NFT mint for "${document.getElementById('nft-name').value}".`;
                    const encodedMessage = new TextEncoder().encode(message);
                    await connectedWallet.signMessage(encodedMessage, "utf8");
                    alert("Signature successful! NFT would be minted now.");
                    closeNftModal();
                } catch (error) {
                    alert("Signature was cancelled. Minting failed.");
                }
            }

            // --- AVVIO E GESTIONE ---
            setCanvasDimensions();
            animationLoop();
            window.addEventListener('resize', setCanvasDimensions);

            // Event Listeners
            heroConnectButton.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            phantomBtn.addEventListener('click', connectPhantom);
            solflareBtn.addEventListener('click', connectSolflare);
            dashboardButton.addEventListener('click', toggleDashboard);
            disconnectBtn.addEventListener('click', disconnectWallet);
            copyAddressBtn.addEventListener('click', copyAddress);
            buyNftButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const rarity = e.target.dataset.rarity;
                    const price = e.target.dataset.price;
                    openPurchaseModal(rarity, price);
                });
            });
            closePurchaseModalBtn.addEventListener('click', closePurchaseModal);
            confirmPurchaseBtn.addEventListener('click', handlePurchase);
            createNftButton.addEventListener('click', openNftModal);
            closeNftModalBtn.addEventListener('click', closeNftModal);
            mintNftButton.addEventListener('click', handleMint);

            document.addEventListener('click', (event) => {
                if (!walletContainer.contains(event.target)) {
                    walletDashboard.classList.add('hidden');
                }
            });
        };
    </script>
</body>
</html>
